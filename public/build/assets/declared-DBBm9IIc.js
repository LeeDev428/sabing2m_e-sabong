import{r,u as G,a,j as e,H as U}from"./app-B_hJgDUS.js";import{D as z}from"./declarator-layout-Bt0wZCne.js";import"./app-BrX23xjj.js";function Z({declared_fights:g=[],tellers:H=[]}){const[D,h]=r.useState(!1),[E,p]=r.useState(!1),[L,y]=r.useState(!1),[_,j]=r.useState(!1),[d,o]=r.useState("meron"),[s,l]=r.useState(null),[c,f]=r.useState("7.5"),[Y,V]=r.useState(null),[q,J]=r.useState({}),{data:i,setData:x,post:k,processing:v,errors:C}=G({new_result:""});r.useEffect(()=>{const t=setInterval(()=>{a.reload({only:["declared_fights","tellers"],preserveScroll:!0,preserveState:!0})},3e3);return()=>clearInterval(t)},[]);const m=g[0],b=m&&m.status==="result_declared"&&m.result&&m.result!=="",$=t=>{l(t),o("meron"),j(!0)},R=()=>{s&&a.post(`/declarator/declare/${s.id}`,{result:d},{onSuccess:()=>{j(!1),l(null)}})},A=t=>{l(t),x("new_result",t.result),h(!0)},F=t=>{l(t),p(!0)},T=t=>{t.preventDefault(),s&&k(`/declarator/change-result/${s.id}`,{onSuccess:()=>{h(!1),l(null)}})},u=(t,n)=>{a.post(`/declarator/fights/${t}/status`,{status:n},{preserveScroll:!0,onSuccess:()=>{p(!1),l(null)}})},M=t=>{a.post(`/declarator/bet-controls/${t}/toggle-meron`,{},{preserveScroll:!0})},W=t=>{a.post(`/declarator/bet-controls/${t}/toggle-wala`,{},{preserveScroll:!0})},P=t=>{l(t),f(t.commission_percentage?.toString()||"7.5"),y(!0)},B=()=>{s&&a.post(`/declarator/bet-controls/${s.id}/commission`,{commission_percentage:parseFloat(c)},{preserveScroll:!0,onSuccess:()=>{y(!1),l(null)}})},S=t=>{switch(t){case"meron":return"bg-red-600";case"wala":return"bg-blue-600";case"draw":return"bg-green-600";case"cancelled":return"bg-gray-600";default:return"bg-purple-600"}},I=t=>{switch(t){case"standby":return"bg-gray-600";case"open":return"bg-green-600";case"lastcall":return"bg-yellow-600";case"closed":return"bg-red-600";case"result_declared":return"bg-blue-600";case"cancelled":return"bg-gray-500";default:return"bg-gray-600"}},O=t=>{switch(t){case"standby":return"STANDBY";case"open":return"BETTING OPEN";case"lastcall":return"LAST CALL";case"closed":return"BETTING CLOSED";case"result_declared":return"RESULT DECLARED";case"cancelled":return"CANCELLED";default:return t.toUpperCase()}};return e.jsxs(z,{children:[e.jsx(U,{title:"Declared Fights"}),e.jsxs("div",{className:"p-4 lg:p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 lg:mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-white mb-2",children:"Declared Fights"}),e.jsx("p",{className:"text-sm lg:text-base text-gray-400",children:"View and manage declared fight results"})]}),e.jsx("button",{onClick:()=>{b&&a.post("/declarator/fights/create-next",{})},disabled:!b,className:`px-6 py-3 rounded-lg font-semibold flex items-center gap-2 ${b?"bg-blue-600 hover:bg-blue-700 cursor-pointer":"bg-gray-600 cursor-not-allowed opacity-50"}`,title:b?"Create next fight":"Latest fight must be closed and declared",children:"âž• Next Fight"})]}),e.jsxs("div",{className:"grid gap-4 lg:gap-6",children:[g.map(t=>{const n=(t.total_meron_bets||0)+(t.total_wala_bets||0),N=n>0?(t.total_meron_bets||0)/n*100:50,w=n>0?(t.total_wala_bets||0)/n*100:50;return e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-8 hover:bg-gray-750 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"text-3xl font-bold text-white",children:["#",t.fight_number]}),e.jsx("span",{className:`px-4 py-1 rounded-full text-sm font-medium ${I(t.status)}`,children:O(t.status)}),t.result&&e.jsxs("span",{className:`px-4 py-1 rounded-full text-sm font-medium ${S(t.result)}`,children:["Result: ",t.result.toUpperCase()]}),t.commission_percentage!==void 0&&e.jsxs("button",{onClick:()=>P(t),className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 rounded-full text-xs font-semibold text-white",children:["Commission: ",t.commission_percentage,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:`border rounded-lg p-4 ${t.result==="meron"?"bg-red-900/50 border-red-500":"bg-red-900/30 border-red-700"}`,children:[e.jsxs("div",{className:"text-xs text-red-300 mb-2",children:["MERON ",t.result==="meron"&&"ðŸ‘‘ WINNER"]}),e.jsx("div",{className:"font-bold text-white mb-2",children:t.meron_fighter}),e.jsxs("div",{className:"text-2xl font-bold text-red-400",children:[t.meron_odds||"---","x"]})]}),e.jsxs("div",{className:`border rounded-lg p-4 ${t.result==="draw"?"bg-green-900/50 border-green-500":"bg-green-900/30 border-green-700"}`,children:[e.jsxs("div",{className:"text-xs text-green-300 mb-2",children:["DRAW ",t.result==="draw"&&"ðŸ‘‘"]}),e.jsx("div",{className:"font-bold text-white mb-2",children:"Match Draw"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[t.draw_odds||"---","x"]})]}),e.jsxs("div",{className:`border rounded-lg p-4 ${t.result==="wala"?"bg-blue-900/50 border-blue-500":"bg-blue-900/30 border-blue-700"}`,children:[e.jsxs("div",{className:"text-xs text-blue-300 mb-2",children:["WALA ",t.result==="wala"&&"ðŸ‘‘ WINNER"]}),e.jsx("div",{className:"font-bold text-white mb-2",children:t.wala_fighter}),e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[t.wala_odds||"---","x"]})]}),e.jsxs("div",{className:"flex flex-col justify-center bg-gray-700/50 border border-gray-600 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Total Bets"}),e.jsx("div",{className:"text-xl font-bold text-white mb-3",children:t.total_bets}),e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Payouts"}),e.jsxs("div",{className:"text-lg font-bold text-green-400",children:["â‚±",t.total_payouts.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Created:"})," ",new Date(t.created_at).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Declared:"})," ",new Date(t.declared_at).toLocaleString()]})]}),(t.status==="open"||t.status==="lastcall"||t.status==="standby")&&e.jsxs("div",{className:"mt-6 border-t border-gray-700 pt-6",children:[e.jsx("h4",{className:"text-lg font-bold text-white mb-4",children:"ðŸŽ® Bet Controls"}),n>0&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex h-10 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-red-600 flex items-center justify-center text-white font-bold transition-all text-sm",style:{width:`${N}%`},children:N>15&&`${N.toFixed(0)}%`}),e.jsx("div",{className:"bg-blue-600 flex items-center justify-center text-white font-bold transition-all text-sm",style:{width:`${w}%`},children:w>15&&`${w.toFixed(0)}%`})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:`border-2 rounded-lg p-4 transition-all ${t.meron_betting_open?"border-red-600 bg-red-900/20":"border-gray-600 bg-gray-700/50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-red-400 font-bold mb-1",children:"MERON"}),e.jsx("p",{className:"text-white text-sm font-semibold",children:t.meron_fighter})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-gray-400 text-xs",children:"Bets"}),e.jsxs("div",{className:"text-white font-bold",children:["â‚±",(t.total_meron_bets||0).toLocaleString()]})]})]}),e.jsx("button",{onClick:()=>M(t.id),className:`w-full py-2 rounded-lg font-bold transition-all text-sm ${t.meron_betting_open?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-600 hover:bg-gray-500 text-gray-300"}`,children:t.meron_betting_open?"âœ… ACCEPTING":"ðŸ”’ CLOSED"}),!t.meron_betting_open&&e.jsx("p",{className:"text-yellow-400 text-xs mt-2 text-center",children:"âš ï¸ Tellers cannot bet on Meron"})]}),e.jsxs("div",{className:`border-2 rounded-lg p-4 transition-all ${t.wala_betting_open?"border-blue-600 bg-blue-900/20":"border-gray-600 bg-gray-700/50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-blue-400 font-bold mb-1",children:"WALA"}),e.jsx("p",{className:"text-white text-sm font-semibold",children:t.wala_fighter})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-gray-400 text-xs",children:"Bets"}),e.jsxs("div",{className:"text-white font-bold",children:["â‚±",(t.total_wala_bets||0).toLocaleString()]})]})]}),e.jsx("button",{onClick:()=>W(t.id),className:`w-full py-2 rounded-lg font-bold transition-all text-sm ${t.wala_betting_open?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-600 hover:bg-gray-500 text-gray-300"}`,children:t.wala_betting_open?"âœ… ACCEPTING":"ðŸ”’ CLOSED"}),!t.wala_betting_open&&e.jsx("p",{className:"text-yellow-400 text-xs mt-2 text-center",children:"âš ï¸ Tellers cannot bet on Wala"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 min-w-[160px]",children:[e.jsx("button",{onClick:()=>F(t),className:"px-4 py-2.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium whitespace-nowrap",children:"Change Status"}),e.jsx("button",{onClick:()=>a.visit(`/declarator/fights/${t.id}/edit`),className:"px-4 py-2.5 bg-blue-700 hover:bg-blue-600 rounded-lg text-sm font-medium whitespace-nowrap",children:"âœï¸ Edit Fight"}),t.status==="closed"&&!t.result&&e.jsx("button",{onClick:()=>$(t),className:"px-4 py-2.5 bg-yellow-600 hover:bg-yellow-700 rounded-lg text-sm font-medium whitespace-nowrap",children:"ðŸ† Declare Result"}),t.result&&e.jsx("button",{onClick:()=>A(t),className:"px-4 py-2.5 bg-yellow-700 hover:bg-yellow-600 rounded-lg text-sm font-medium whitespace-nowrap",children:"Change Result"})]})]})},t.id)}),g.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("p",{className:"text-xl font-medium mb-2",children:"No declared fights yet"}),e.jsx("p",{className:"text-sm",children:"Declared fights will appear here"})]})]})]}),D&&s&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full border border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Change Result - Fight #",s.fight_number]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-700 rounded",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Current Matchup:"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("span",{className:"text-red-400 font-semibold",children:s.meron_fighter}),e.jsx("span",{className:"text-gray-500",children:"vs"}),e.jsx("span",{className:"text-blue-400 font-semibold",children:s.wala_fighter})]}),e.jsxs("div",{className:"text-sm text-gray-400 mt-2",children:["Current Result: ",e.jsx("span",{className:`font-bold ${S(s.result)} px-2 py-0.5 rounded`,children:s.result.toUpperCase()})]})]}),e.jsxs("form",{onSubmit:T,children:[e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("button",{type:"button",onClick:()=>x("new_result","meron"),className:`w-full px-4 py-3 rounded-lg text-left font-medium transition-colors ${i.new_result==="meron"?"bg-red-600 ring-2 ring-red-400":"bg-red-800/50 hover:bg-red-700"}`,children:["ðŸ‘Š MERON - ",s.meron_fighter]}),e.jsxs("button",{type:"button",onClick:()=>x("new_result","wala"),className:`w-full px-4 py-3 rounded-lg text-left font-medium transition-colors ${i.new_result==="wala"?"bg-blue-600 ring-2 ring-blue-400":"bg-blue-800/50 hover:bg-blue-700"}`,children:["ðŸ‘Š WALA - ",s.wala_fighter]}),e.jsx("button",{type:"button",onClick:()=>x("new_result","draw"),className:`w-full px-4 py-3 rounded-lg text-left font-medium transition-colors ${i.new_result==="draw"?"bg-green-600 ring-2 ring-green-400":"bg-green-800/50 hover:bg-green-700"}`,children:"ðŸ¤ DRAW"}),e.jsx("button",{type:"button",onClick:()=>x("new_result","cancelled"),className:`w-full px-4 py-3 rounded-lg text-left font-medium transition-colors ${i.new_result==="cancelled"?"bg-gray-600 ring-2 ring-gray-400":"bg-gray-700/50 hover:bg-gray-600"}`,children:"âŒ CANCELLED"})]}),C.new_result&&e.jsx("p",{className:"text-sm text-red-500 mb-4",children:C.new_result}),e.jsx("div",{className:"bg-yellow-900/30 border border-yellow-700 p-3 rounded mb-6",children:e.jsx("p",{className:"text-yellow-300 text-sm",children:"âš ï¸ Warning: This will recalculate all payouts for this fight!"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{h(!1),l(null)},className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v||!i.new_result,className:"flex-1 px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg font-medium disabled:opacity-50",children:v?"Changing...":"Change Result"})]})]})]})}),E&&s&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full border border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Change Status - Fight #",s.fight_number]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("button",{onClick:()=>u(s.id,"standby"),disabled:s.status==="standby",className:"w-full px-4 py-3 bg-gray-600 hover:bg-gray-700 rounded-lg text-left font-medium disabled:opacity-50",children:"â¸ï¸ STANDBY"}),e.jsx("button",{onClick:()=>u(s.id,"open"),disabled:s.status==="open",className:"w-full px-4 py-3 bg-green-600 hover:bg-green-700 rounded-lg text-left font-medium disabled:opacity-50",children:"âœ… OPEN BETTING"}),e.jsx("button",{onClick:()=>u(s.id,"lastcall"),disabled:s.status==="lastcall",className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-700 rounded-lg text-left font-medium disabled:opacity-50",children:"âš ï¸ LAST CALL"}),e.jsx("button",{onClick:()=>u(s.id,"closed"),disabled:s.status==="closed",className:"w-full px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg text-left font-medium disabled:opacity-50",children:"ðŸ”’ CLOSE BETTING"})]}),e.jsx("button",{onClick:()=>{p(!1),l(null)},className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"})]})}),_&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 max-w-2xl w-full",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-6",children:["Declare Result - Fight #",s.fight_number]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-400 mb-4",children:"Select the winning side:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>o("meron"),className:`p-6 rounded-lg text-center transition-all ${d==="meron"?"bg-red-600 ring-4 ring-red-400":"bg-gray-700 hover:bg-gray-600"}`,children:[e.jsx("p",{className:"text-white text-xl font-bold",children:"MERON"}),e.jsx("p",{className:"text-white text-lg mt-2",children:s.meron_fighter})]}),e.jsxs("button",{onClick:()=>o("wala"),className:`p-6 rounded-lg text-center transition-all ${d==="wala"?"bg-blue-600 ring-4 ring-blue-400":"bg-gray-700 hover:bg-gray-600"}`,children:[e.jsx("p",{className:"text-white text-xl font-bold",children:"WALA"}),e.jsx("p",{className:"text-white text-lg mt-2",children:s.wala_fighter})]}),e.jsxs("button",{onClick:()=>o("draw"),className:`p-6 rounded-lg text-center transition-all ${d==="draw"?"bg-green-600 ring-4 ring-green-400":"bg-gray-700 hover:bg-gray-600"}`,children:[e.jsx("p",{className:"text-white text-xl font-bold",children:"DRAW"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Match Tied"})]}),e.jsxs("button",{onClick:()=>o("cancelled"),className:`p-6 rounded-lg text-center transition-all ${d==="cancelled"?"bg-gray-600 ring-4 ring-gray-400":"bg-gray-700 hover:bg-gray-600"}`,children:[e.jsx("p",{className:"text-white text-xl font-bold",children:"CANCELLED"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Refund all bets"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{j(!1),l(null)},className:"flex-1 px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg font-semibold",children:"Cancel"}),e.jsx("button",{onClick:R,className:"flex-1 px-6 py-3 bg-yellow-600 hover:bg-yellow-700 rounded-lg font-semibold",children:"ðŸ† Confirm Declaration"})]})]})}),L&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Set Commission Percentage"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:["Fight #",s.fight_number,": ",s.meron_fighter," vs ",s.wala_fighter]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:"Commission Percentage (%)"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",value:c,onChange:t=>f(t.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-white text-lg"}),e.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"Default is 7.5%. This will be deducted from the total pot before payout."})]}),(s.total_meron_bets||0)+(s.total_wala_bets||0)>0&&e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4 mb-6 text-sm",children:[e.jsx("p",{className:"text-gray-400 mb-2",children:"Example with current pot:"}),e.jsxs("div",{className:"space-y-1 text-gray-300",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Pot:"}),e.jsxs("span",{className:"font-semibold",children:["â‚±",((s.total_meron_bets||0)+(s.total_wala_bets||0)).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-purple-400",children:[e.jsxs("span",{children:["Commission (",c,"%):"]}),e.jsxs("span",{className:"font-semibold",children:["â‚±",(((s.total_meron_bets||0)+(s.total_wala_bets||0))*(parseFloat(c)/100)).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1",children:[e.jsx("span",{children:"Net Pot:"}),e.jsxs("span",{className:"font-semibold text-green-400",children:["â‚±",(((s.total_meron_bets||0)+(s.total_wala_bets||0))*(1-parseFloat(c)/100)).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{y(!1),l(null)},className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:B,className:"flex-1 px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg font-medium",children:"Update Commission"})]})]})})]})}export{Z as default};
