import{c as M,r as b,j as t,a as p,H as B}from"./app-dqaPwGaj.js";import{T as $}from"./teller-layout-N_6DpDw3.js";import{H as D}from"./html5-qrcode-scanner-B6Sen6cS.js";import{s as F}from"./toast-kz1Cz6CV.js";import"./app-CyxfocGy.js";function te(a){const e=M.c(31),{message:l,claimData:s}=a,[h,f]=b.useState(!1),[,T]=b.useState(null),[g,A]=b.useState(null),r=b.useRef(null),c=b.useRef(!1);let j,y;e[0]===Symbol.for("react.memo_cache_sentinel")?(j=()=>()=>{r.current&&c.current&&r.current.stop().catch(G)},y=[],e[0]=j,e[1]=y):(j=e[0],y=e[1]),b.useEffect(j,y);let N;e[2]===Symbol.for("react.memo_cache_sentinel")?(N=async()=>{try{A(null),T(null),f(!0),await new Promise(z),await navigator.mediaDevices.getUserMedia({video:!0});const n=new D("qr-reader");r.current=n,await n.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},u=>{console.log("üéØ Payout QR Code scanned:",u),T(u),c.current=!1,n.stop(),f(!1),console.log("üí∞ Sending payout claim request..."),p.post("/teller/payout-scan/claim",{ticket_id:u},{preserveScroll:!1,onSuccess:W,onError:Q=>{console.error("‚ùå Payout claim failed:",Q);const H=typeof Q=="object"?JSON.stringify(Q):String(Q);A(H),F(`‚ùå Failed to claim: ${H}`,"error",5e3)}})},V),c.current=!0,console.log("‚úÖ Payout scanner started successfully")}catch(n){const u=n;console.error("‚ùå Payout scanner failed to start:",u),A(u.message||"Failed to start camera"),f(!1),c.current=!1}},e[2]=N):N=e[2];const q=N;let v;e[3]===Symbol.for("react.memo_cache_sentinel")?(v=()=>{r.current&&c.current&&(c.current=!1,r.current.stop().then(()=>{f(!1),r.current=null}).catch(n=>{console.log("Stop scanner error:",n.message),f(!1)}))},e[3]=v):v=e[3];const L=v;let S;e[4]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx(B,{title:"Payout Scanning"}),e[4]=S):S=e[4];let _;e[5]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 mb-4 border border-gray-700",children:[t.jsx("h1",{className:"text-2xl font-bold text-orange-500 mb-1",children:"Payout Scanning"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Scan QR code on bet ticket to claim winnings"})]}),e[5]=_):_=e[5];let o;e[6]!==g||e[7]!==s||e[8]!==l||e[9]!==h?(o=!s&&!l&&t.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 mb-4 border border-gray-700",children:[t.jsx("div",{id:"qr-reader",className:`rounded-lg overflow-hidden ${h?"":"hidden"}`}),!h&&!g&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-6xl mb-4",children:"üì∑"}),t.jsx("p",{className:"text-gray-400 mb-4",children:"Ready to scan QR code"}),t.jsx("button",{onClick:q,className:"bg-blue-600 hover:bg-blue-700 px-8 py-3 rounded-lg font-bold",children:"Start Camera"})]}),g&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-6xl mb-4",children:"‚ö†Ô∏è"}),t.jsx("p",{className:"text-red-400 mb-4",children:g}),t.jsx("button",{onClick:q,className:"bg-blue-600 hover:bg-blue-700 px-8 py-3 rounded-lg font-bold",children:"Try Again"})]}),h&&t.jsx("div",{className:"text-center mt-4",children:t.jsx("button",{onClick:L,className:"bg-red-600 hover:bg-red-700 px-8 py-3 rounded-lg font-bold",children:"Stop Scanning"})})]}),e[6]=g,e[7]=s,e[8]=l,e[9]=h,e[10]=o):o=e[10];let i;e[11]!==s?(i=s&&!s.already_claimed&&t.jsxs("div",{className:"bg-green-900/30 border-2 border-green-500 rounded-lg p-6 mb-4",children:[t.jsxs("div",{className:"text-center mb-6",children:[t.jsx("div",{className:"text-7xl mb-4",children:"‚úÖ"}),t.jsx("h2",{className:"text-3xl font-bold text-green-400 mb-2",children:"Success!"}),t.jsx("p",{className:"text-white text-xl",children:"Claimed Successfully"})]}),t.jsxs("div",{className:"space-y-4 bg-[#1a1a1a] rounded-lg p-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:"Claimed Amount:"}),t.jsxs("span",{className:"text-3xl font-bold text-yellow-400",children:["‚Ç±",s.amount.toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between items-center border-t border-gray-700 pt-4",children:[t.jsx("span",{className:"text-gray-400",children:"Bet By:"}),t.jsx("span",{className:"text-white font-semibold",children:s.bet_by})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:"Claimed By:"}),t.jsx("span",{className:"text-white font-semibold",children:s.claimed_by})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:"Status:"}),t.jsx("span",{className:"text-green-400 font-bold",children:s.status})]})]}),t.jsx("button",{onClick:U,className:"w-full mt-6 bg-blue-600 hover:bg-blue-700 py-3 rounded-lg font-bold",children:"Scan Another"})]}),e[11]=s,e[12]=i):i=e[12];let d;e[13]!==s?(d=s&&s.already_claimed&&t.jsxs("div",{className:"bg-yellow-900/30 border-2 border-yellow-500 rounded-lg p-6 mb-4",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("div",{className:"text-7xl mb-4",children:"‚ö†Ô∏è"}),t.jsx("h2",{className:"text-3xl font-bold text-yellow-400 mb-2",children:"Already Claimed!"}),t.jsx("p",{className:"text-white",children:"This ticket has already been redeemed"})]}),t.jsx("button",{onClick:O,className:"w-full mt-6 bg-blue-600 hover:bg-blue-700 py-3 rounded-lg font-bold",children:"Scan Another"})]}),e[13]=s,e[14]=d):d=e[14];let m;e[15]!==l?(m=l&&l.includes("Lost")&&t.jsxs("div",{className:"bg-red-900/30 border-2 border-red-500 rounded-lg p-6 mb-4",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("div",{className:"text-7xl mb-4",children:"‚ùå"}),t.jsx("h2",{className:"text-3xl font-bold text-red-400 mb-2",children:"Cannot Claim"}),t.jsx("p",{className:"text-white text-xl",children:l})]}),t.jsx("button",{onClick:J,className:"w-full mt-6 bg-blue-600 hover:bg-blue-700 py-3 rounded-lg font-bold",children:"Scan Another"})]}),e[15]=l,e[16]=m):m=e[16];let x;e[17]!==s||e[18]!==l?(x=l&&!l.includes("Lost")&&!s&&t.jsxs("div",{className:"bg-red-900/30 border-2 border-red-500 rounded-lg p-6 mb-4",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("div",{className:"text-7xl mb-4",children:"‚ö†Ô∏è"}),t.jsx("h2",{className:"text-2xl font-bold text-red-400 mb-2",children:"Error"}),t.jsx("p",{className:"text-white",children:l})]}),t.jsx("button",{onClick:I,className:"w-full mt-6 bg-blue-600 hover:bg-blue-700 py-3 rounded-lg font-bold",children:"Try Again"})]}),e[17]=s,e[18]=l,e[19]=x):x=e[19];let w;e[20]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsx("h3",{className:"font-bold text-lg mb-2",children:"üìã Instructions"}),e[20]=w):w=e[20];let C;e[21]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-400",children:"1."}),t.jsx("span",{children:'Click "Start Camera" to activate the QR scanner'})]}),e[21]=C):C=e[21];let R;e[22]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-400",children:"2."}),t.jsx("span",{children:"Position the bet ticket QR code within the camera view"})]}),e[22]=R):R=e[22];let k;e[23]===Symbol.for("react.memo_cache_sentinel")?(k=t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-400",children:"3."}),t.jsx("span",{children:"Wait for automatic detection and claim validation"})]}),e[23]=k):k=e[23];let P;e[24]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 border border-gray-700",children:[w,t.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[C,R,k,t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-400",children:"4."}),t.jsx("span",{children:"View claim status and payout amount"})]})]})]}),e[24]=P):P=e[24];let E;return e[25]!==m||e[26]!==x||e[27]!==o||e[28]!==i||e[29]!==d?(E=t.jsxs($,{currentPage:"payout",children:[S,t.jsxs("div",{className:"p-4 max-w-md mx-auto",children:[_,o,i,d,m,x,P]})]}),e[25]=m,e[26]=x,e[27]=o,e[28]=i,e[29]=d,e[30]=E):E=e[30],E}function I(){return p.visit("/teller/payout-scan")}function J(){return p.visit("/teller/payout-scan")}function O(){return p.visit("/teller/payout-scan")}function U(){return p.visit("/teller/payout-scan")}function V(a){}function W(a){console.log("‚úÖ Payout claim successful:",a.props)}function z(a){return setTimeout(a,100)}function G(a){console.log("Scanner cleanup:",a.message)}export{te as default};
